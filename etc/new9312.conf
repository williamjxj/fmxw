source contents
{
	type	= mysql
	sql_host	= localhost
	sql_user	= coreseek
	sql_pass	= sphinx20121018
	sql_db		= dixi
	sql_port	= 3306
	sql_sock	= /var/lib/mysql/mysql.sock
	
	sql_query_pre		= SET NAMES utf8
	sql_query_pre		= SET SESSION query_cache_type=OFF

    sql_query_pre		= REPLACE INTO sph_counter SELECT 1, MAX(cid) FROM contents
	sql_query_range		= SELECT MIN(cid), MAX(cid) FROM contents
	sql_range_step		= 1000

	sql_query = SELECT cid, title, url, UNIX_TIMESTAMP(pubdate) pubdate, author, source, content, category, cate_id, item, iid, language, \
					clicks, tags, likes, fandui, guanzhu, pinglun, createdby, UNIX_TIMESTAMP(created) created FROM contents \
					WHERE cid >= $start AND cid <= $end
		
	sql_attr_uint 			= cate_id
	sql_attr_uint	 		= iid
	sql_attr_str2ordinal	= language
	sql_attr_str2ordinal	= createdby
	sql_attr_uint			= clicks
	sql_attr_uint			= guanzhu
	sql_attr_uint			= pinglun
	sql_attr_uint			= likes
	sql_attr_uint			= fandui
	sql_attr_string	= tags
	sql_attr_timestamp		= created
	
	sql_query_info	= SELECT * FROM contents WHERE cid=$id
}

source increment : contents
{
	sql_query_pre		= SET SESSION query_cache_type=OFF
	sql_query_pre		= SET NAMES utf8
	sql_query_range		= 
	sql_query = SELECT cid, title, url, pubdate, author, source, content, category, cate_id, item, iid, language, \
					clicks, tags, likes, fandui, guanzhu, pinglun, createdby, UNIX_TIMESTAMP(created) created FROM contents \
							WHERE cid > ( SELECT max_id FROM sph_counter WHERE counter_id=1 )
	sql_attr_uint 			= cate_id
	sql_attr_uint	 		= iid
	sql_attr_str2ordinal	= language
	sql_attr_str2ordinal	= createdby
	sql_attr_uint			= clicks
	sql_attr_uint			= guanzhu
	sql_attr_uint			= pinglun
	sql_attr_uint			= likes
	sql_attr_uint			= fandui
	sql_attr_string	= tags
	sql_attr_timestamp		= created
}

source comments
{
	type	= mysql
	sql_host	= localhost
	sql_user	= coreseek
	sql_pass	= sphinx20121018
	sql_db		= dixi
	sql_port	= 3306
	sql_sock	= /var/lib/mysql/mysql.sock
	
	sql_query_pre		= SET NAMES utf8
	sql_query_pre		= SET SESSION query_cache_type=OFF

    sql_query_pre		= REPLACE INTO sph_counter SELECT 2, MAX(id) FROM comments
	sql_query_range		= SELECT MIN(id), MAX(id) FROM comments
	sql_query			= SELECT id, uid, comment, create_time, author, email, cid, area, zhichi \
							FROM comments where id >= $start AND id <= $end 
}
source newdata : comments
{
	sql_query_pre		= SET SESSION query_cache_type=OFF
	sql_query_pre		= SET NAMES utf8
	sql_query_range		= 
	sql_range_step		=
	sql_query			= SELECT id, uid, comment, create_time, author, email, cid, area, zhichi \
							FROM comments where id > ( SELECT max_id FROM sph_counter WHERE counter_id=2 )
}

source keyRelated
{
	type	= mysql
	sql_host	= localhost
	sql_user	= coreseek
	sql_pass	= sphinx20121018
	sql_db		= dixi
	sql_port	= 3306		#/etc/my.cnf
	sql_sock	= /var/lib/mysql/mysql.sock
	
	sql_query_pre		= SET NAMES utf8
	sql_query_pre		= SET SESSION query_cache_type=OFF

	sql_query			= SELECT rid, rk, kurl, kid, keyword FROM key_related

	sql_attr_uint	 		= kid
	#sql_attr_string		= keyword
	sql_attr_str2ordinal	= keyword
}
source delta : keyRelated
{
	sql_query	=  SELECT rid, rk, kurl, kid, keyword FROM key_related
}

index keyRelated
{
	source				= keyRelated
	path				= /var/data/new/keyRelated
	docinfo				= extern
	ngram_len			= 0
	min_word_len		= 3
	charset_type		= zh_cn.utf-8
	charset_dictpath	= /usr/local/mmseg/etc/
	stopwords			= /usr/local/mmseg/etc/stopwords.txt
	mlock				= 0
	morphology			= none
}
index delta : keyRelated
{
	source	= delta
	path	= /var/data/new/delta
}

index comments
{
	source				= comments
	path				= /var/data/new/comments
	docinfo				= extern
	ngram_len			= 0
	min_word_len		= 3
	charset_type		= zh_cn.utf-8
	charset_dictpath	= /usr/local/mmseg/etc/
	stopwords			= /usr/local/mmseg/etc/stopwords.txt
	mlock				= 0
	morphology			= none
}
index newdata : comments
{
	source	= newdata
	path	= /var/data/new/newdata
}


index contents
{
	source				= contents
	path				= /var/data/new/contents

	charset_dictpath	= /usr/local/mmseg/etc/
	charset_type		= zh_cn.utf-8
	stopwords			= /usr/local/mmseg/etc/stopwords.txt
	ngram_len			= 0

	docinfo		= extern
	morphology	= none
	min_word_len	= 3
}
index increment : contents
{
	source = increment
	path = /var/data/new/increment
}

indexer
{
    mem_limit            = 256M
}

searchd
{
	port				= 9312
	log					= /var/log/new/searchd.log
	query_log			= /var/log/new/query.log
	pid_file			= /var/log/new/searchd.pid
}
